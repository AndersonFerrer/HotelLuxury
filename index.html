<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Disfruta de una estancia inolvidable en Luxury Hotel. Habitaciones de lujo, servicios premium y ubicación privilegiada para viajeros exigentes."
    />
    <meta
      name="keywords"
      content="hotel de lujo, habitaciones premium, alojamiento exclusivo, reserva hotel, spa, restaurante gourmet"
    />
    <title>Luxury Hotel</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./styles/styles.css" />
    <link rel="stylesheet" href="./styles/footer.css" />
    <link rel="stylesheet" href="./styles/navbar.css" />
  </head>
  <body>
    <!-- Navbar -->
    <div id="navbar-root"></div>
    <!-- Hero -->
    <section class="hero">
      <div class="hero-image"></div>
      <div class="hero-content">
        <h1 class="hero-title">Experiencia de Lujo y Confort</h1>
        <p class="hero-subtitle">
          Disfruta de una estancia inolvidable en nuestras exclusivas
          instalaciones
        </p>
        <a href="auth.html" class="btn btn-primary btn-lg">
          Reservar Ahora <i class="fas fa-chevron-right"></i>
        </a>
      </div>
    </section>

    <!-- Seccion sobre nostros -->
    <section class="about">
      <div class="about-container">
        <div class="about-content">
          <div class="about-text">
            <h2 class="section-title">
              Bienvenido a <span class="highlight">Luxury Hotel</span>
            </h2>
            <p class="about-description">
              Nuestro hotel de cinco estrellas ofrece una experiencia única de
              hospitalidad, combinando elegancia moderna con comodidades de
              lujo. Situado en una ubicación privilegiada, somos el destino
              perfecto para viajeros exigentes.
            </p>
            <div class="feature">
              <i class="fas fa-map-marker-alt feature-icon"></i>
              <span class="feature-text"
                >Ubicación privilegiada en el centro de la ciudad</span
              >
            </div>
            <div class="feature">
              <i class="fas fa-star feature-icon"></i>
              <span class="feature-text"
                >Servicio de cinco estrellas y atención personalizada</span
              >
            </div>
            <div class="feature">
              <i class="fas fa-calendar feature-icon"></i>
              <span class="feature-text"
                >Disponibilidad durante todo el año</span
              >
            </div>
          </div>
          <div class="about-image">
            <img
              src="https://images.unsplash.com/photo-1517840901100-8179e982acb7?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="Hotel Interior"
              loading="lazy"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Habitaciones -->
    <section class="rooms">
      <div class="rooms-container">
        <div class="section-header">
          <h2 class="section-title">Nuestras Habitaciones</h2>
          <p class="section-subtitle">
            Descubre nuestras lujosas habitaciones y suites, diseñadas para
            ofrecerte la máxima comodidad y elegancia durante tu estancia.
          </p>
        </div>

        <div id="rooms-container" class="room-cards"></div>

        <!-- <div class="rooms-cta">
          <a href="/rooms" class="btn btn-primary"
            >Ver Todas las Habitaciones</a
          >
        </div> -->
      </div>
    </section>

    <!-- Seccion de Galería -->
    <section class="gallery">
      <div class="gallery-container">
        <div class="section-header">
          <h2 class="section-title">Galería</h2>
          <p class="section-subtitle">
            Explora nuestras instalaciones a través de nuestra galería de
            imágenes
          </p>
        </div>

        <div class="gallery-grid">
          <div class="gallery-item">
            <img
              src="https://cdn.wallpapersafari.com/73/96/P34gqZ.jpg"
              alt="Imagen del hotel 1"
              loading="lazy"
            />
          </div>
          <div class="gallery-item">
            <img
              src="https://cdn.pixabay.com/photo/2021/09/22/08/35/architecture-6646154_1280.jpg"
              alt="Imagen del hotel 2"
              loading="lazy"
            />
          </div>
          <div class="gallery-item">
            <img
              src="https://cdn.pixabay.com/photo/2023/03/29/10/27/hotel-7885138_1280.jpg"
              alt="Imagen del hotel 3"
              loading="lazy"
            />
          </div>
          <div class="gallery-item">
            <img
              src="https://cdn.pixabay.com/photo/2020/02/16/16/28/bar-4854100_1280.jpg"
              alt="Imagen del hotel 4"
              loading="lazy"
            />
          </div>
          <div class="gallery-item">
            <img
              src="https://cdn.pixabay.com/photo/2017/12/06/08/12/pool-3001209_1280.jpg"
              alt="Imagen del hotel 5"
              loading="lazy"
            />
          </div>
          <div class="gallery-item">
            <img
              src="https://cdn.pixabay.com/photo/2016/02/10/13/39/hotel-1191725_1280.jpg"
              alt="Imagen del hotel 6"
              loading="lazy"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Seccion CTA -->
    <section class="cta">
      <div class="cta-container">
        <h2 class="cta-title">¿Listo para una experiencia inolvidable?</h2>
        <p class="cta-subtitle">
          Reserva ahora y disfruta de nuestras promociones especiales y
          beneficios exclusivos para huéspedes.
        </p>
        <a href="auth.html" class="btn btn-primary btn-lg">
          Reservar Ahora <i class="fas fa-chevron-right"></i>
        </a>
      </div>
    </section>

    <!-- Footer -->
    <div id="footer-root"></div>
    <!-- Al final del body -->
    <script type="module" src="./load-component.js" defer></script>
    <script type="module">
      import { 
        setSectionLoading, 
        setSectionNormal, 
        showErrorToast 
      } from './scripts/loaderUtils.js';
      
      let habitaciones = [];

      document.addEventListener("DOMContentLoaded", function () {
        cargarHabitaciones();
      });

      async function cargarHabitaciones() {
        const contenedor = document.getElementById("rooms-container");
        
        try {
          setSectionLoading(contenedor);
          
          const response = await fetch("api/obtenerHabitaciones.php");

          // Verifica si la respuesta fue exitosa
          if (!response.ok) {
            throw new Error(`Error HTTP: ${response.status}`);
          }

          // Verifica que el contenido sea JSON
          const contentType = response.headers.get("Content-Type");
          if (!contentType || !contentType.includes("application/json")) {
            const text = await response.text();
            console.error(
              "Respuesta no es JSON válida. Contenido recibido:",
              text
            );
            throw new TypeError("La respuesta no es JSON");
          }

          const data = await response.json();
          console.log(data);

          if (data.success) {
            habitaciones = data.data;
            console.log("Habitaciones cargadas:", habitaciones);

            // Limpiar contenedor primero
            contenedor.innerHTML = "";
            if (habitaciones.length === 0) {
              contenedor.innerHTML = '<p class="text-center text-gray-500">No se encontraron habitaciones</p>';
              return;
            }
            // Crear y agregar cada tarjeta
            habitaciones.forEach((habitacion) => {
              const tarjetaHTML = crearTarjetaHabitacion(habitacion);
              contenedor.insertAdjacentHTML("beforeend", tarjetaHTML);
            });
          } else {
            console.error("Error del servidor:", data.error);
            showErrorToast("Error al cargar habitaciones: " + data.error);
          }
        } catch (error) {
          console.error("Ocurrió un error al cargar habitaciones:", error);
          showErrorToast("Error al cargar habitaciones. Inténtalo de nuevo.");
        } finally {
          setSectionNormal(contenedor);
        }
      }
      
      function crearTarjetaHabitacion(habitacion) {
        return `
    <div class="room-card">
      <div class="room-image">
        <img
          src="https://images.unsplash.com/photo-1517840901100-8179e982acb7?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
          alt="${habitacion.nombre}"
          loading="lazy"
        />
      </div>
      <div class="room-details">
        <h3 class="room-title">${habitacion.nombre}</h3>
        <p class="room-description">
          ${habitacion.descripcion}
        </p>
        <div class="room-footer">
          <span class="room-price">S/. ${habitacion.precio_noche} / noche</span>
          <a href="room-detail.html?id=${habitacion.id_tipo_habitacion}" class="btn btn-outline" data-funcionalidad="ver_detalles">
            Ver Detalles
          </a>
        </div>
      </div>
    </div>
  `;
      }
    </script>
    <script type="module">
      // Protección para página pública
      import { inicializarProteccionPublica } from './scripts/publicPageProtection.js';
      
      document.addEventListener('DOMContentLoaded', async () => {
        // La protección se ejecuta después de que load-component.js haya cargado la sesión
        setTimeout(async () => {
          await inicializarProteccionPublica();
        }, 100);
      });
    </script>
  </body>
</html>
